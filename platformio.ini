; ============================================================================
; PlatformIO Configuration — ESP32 Desktop Monitor Receiver
; ============================================================================
; Supports:
;   • LILYGO T-Display       (ESP32,    135×240, SPI)
;   • LILYGO T-Display S3    (ESP32-S3, 170×320, 8-bit parallel, touch)
;
; Quick start:
;   pio run -e t-display              # build for T-Display
;   pio run -e t-display-s3-touch     # build for T-Display S3 Touch
;   pio run -e <env> -t upload        # flash to board
;   pio device monitor                # serial monitor
; ============================================================================

[platformio]
default_envs = t-display

; ── Shared settings ──────────────────────────────────────────────────────────
[env]
framework = arduino
monitor_speed = 115200
lib_deps =
    bodmer/TFT_eSPI@^2.5.43

build_flags =
    ; ── WiFi credentials (UPDATE THESE) ──
    '-DWIFI_SSID="YOUR_WIFI_SSID"'
    '-DWIFI_PASSWORD="YOUR_WIFI_PASSWORD"'
    ; ── Common TFT_eSPI configuration ──
    -DUSER_SETUP_LOADED
    -DST7789_DRIVER
    -DLOAD_GLCD
    -DLOAD_FONT2
    -DLOAD_FONT4
    -DLOAD_GFXFF
    -DSMOOTH_FONT

; ── LILYGO T-Display (original ESP32, 135×240, SPI) ─────────────────────────
[env:t-display]
platform = espressif32
board = esp32dev
build_flags =
    ${env.build_flags}
    ; Display geometry
    -DDISPLAY_WIDTH=135
    -DDISPLAY_HEIGHT=240
    ; TFT_eSPI SPI pin mapping
    -DTFT_WIDTH=135
    -DTFT_HEIGHT=240
    -DTFT_MOSI=19
    -DTFT_SCLK=18
    -DTFT_CS=5
    -DTFT_DC=16
    -DTFT_RST=23
    -DTFT_BL=4
    -DTFT_BACKLIGHT_ON=1
    ; SPI clock – lower to 40000000 if the display is unstable
    -DSPI_FREQUENCY=80000000
    -DSPI_READ_FREQUENCY=20000000
    ; Board identifier
    -DBACKLIGHT_PIN=4

; ── LILYGO T-Display S3 Touch (ESP32-S3, 170×320, 8-bit parallel, cap touch) ─
; NOTE: The pixel-update protocol currently encodes Y as uint8 (max 255).
;       At 170×320 the bottom 64 rows (y 256-319) cannot be addressed.
;       Modify the protocol (receiver + transmitter) if full-screen is needed.
[env:t-display-s3-touch]
platform = espressif32
board = lilygo-t-display-s3
upload_port = COM9
board_build.arduino.memory_type = qio_opi
build_flags =
    ${env.build_flags}
    -DARDUINO_USB_CDC_ON_BOOT=1
    ; Display geometry (landscape: rotation=1)
    -DDISPLAY_WIDTH=320
    -DDISPLAY_HEIGHT=170
    ; TFT_eSPI 8-bit parallel pin mapping (T-Display S3 Touch)
    -DTFT_WIDTH=170
    -DTFT_HEIGHT=320
    -DTFT_PARALLEL_8_BIT
    -DINIT_SEQUENCE_3
    -DCGRAM_OFFSET
    -DTFT_INVERSION_ON
    -DTFT_RGB_ORDER=TFT_RGB
    -DTFT_CS=6
    -DTFT_DC=7
    -DTFT_RST=5
    -DTFT_WR=8
    -DTFT_RD=9
    -DTFT_D0=39
    -DTFT_D1=40
    -DTFT_D2=41
    -DTFT_D3=42
    -DTFT_D4=45
    -DTFT_D5=46
    -DTFT_D6=47
    -DTFT_D7=48
    -DTFT_BL=38
    -DTFT_BACKLIGHT_ON=1
    ; Board identifiers
    -DBACKLIGHT_PIN=38
    -DPOWER_ON_PIN=15
    -DBOARD_HAS_PSRAM
